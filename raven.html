<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Raven â€” Map</title>
<style>
html, body {
  margin: 0; padding: 0;
  height: 100%; width: 100%;
  background: #000;
  display: flex;
  align-items: center;
  justify-content: center;
}
canvas {
  background: #111;
  border: 2px solid #555;
}
</style>
</head>
<body>
<canvas id="map" width="500" height="500"></canvas>
<script>
const canvas = document.getElementById('map');
const ctx = canvas.getContext('2d');

const GRID_SIZE = 5;
const CELL_SIZE = canvas.width / GRID_SIZE;
const DOT_RADIUS = 10;
const DOT_DURATION = 10000; // 10s
let dots = [];

function drawGrid() {
  ctx.strokeStyle = "#333";
  ctx.lineWidth = 1;
  for (let i = 0; i <= GRID_SIZE; i++) {
    // vertical lines
    ctx.beginPath();
    ctx.moveTo(i * CELL_SIZE, 0);
    ctx.lineTo(i * CELL_SIZE, canvas.height);
    ctx.stroke();
    // horizontal lines
    ctx.beginPath();
    ctx.moveTo(0, i * CELL_SIZE);
    ctx.lineTo(canvas.width, i * CELL_SIZE);
    ctx.stroke();
  }

  // labels
  ctx.fillStyle = "#aaa";
  ctx.font = "16px monospace";
  const rows = ["A","B","C","D","E"];
  for (let r = 0; r < GRID_SIZE; r++) {
    ctx.fillText(rows[r], 5, r * CELL_SIZE + 20);
  }
  for (let c = 1; c <= GRID_SIZE; c++) {
    ctx.fillText(c, c * CELL_SIZE - CELL_SIZE/2, canvas.height - 5);
  }
}

function drawDots() {
  const now = Date.now();
  dots = dots.filter(dot => dot.expires > now);

  for (let dot of dots) {
    const rowIndex = ["A","B","C","D","E"].indexOf(dot.row);
    const colIndex = dot.col - 1;

    if (rowIndex < 0 || colIndex < 0) continue;

    const x = colIndex * CELL_SIZE + CELL_SIZE / 2;
    const y = rowIndex * CELL_SIZE + CELL_SIZE / 2;

    ctx.fillStyle = dot.color;
    ctx.beginPath();
    ctx.arc(x, y, DOT_RADIUS, 0, 2 * Math.PI);
    ctx.fill();
  }
}

function render() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawGrid();
  drawDots();
  requestAnimationFrame(render);
}
render();

window.addEventListener("message", e => {
  const { row, col, color } = e.data;
  if (!row || !col) return;
  dots.push({
    row,
    col,
    color: color || "white",
    expires: Date.now() + DOT_DURATION
  });
});
</script>
</body>
</html>
